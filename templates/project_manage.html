<!DOCTYPE html>
<html>
  <head>
      {% load static %}
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>郑州市建筑劳务监管平台</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="robots" content="all,follow">
    <!-- Bootstrap CSS-->
    <link rel="stylesheet" href="{% static '/css/vendor/bootstrap/bootstrap.min.css'  %}">
    <!-- Font Awesome CSS-->
    <link rel="stylesheet" href="{% static '/css/vendor/font-awesome/font-awesome.min.css'  %}">
    <!-- Fontastic Custom icon font-->
    <link rel="stylesheet" href="{% static 'css/fontastic.css'  %}">
    <!-- Google fonts - Poppins -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,700">
    <!-- theme stylesheet-->
    <link rel="stylesheet" href="{% static 'css/style.default.css'  %}" id="theme-stylesheet">
    <!-- Custom stylesheet - for your changes-->
    <link rel="stylesheet" href="{% static 'css/custom.css'  %}">
    <!-- Favicon-->
    <link rel="shortcut icon" href="{% static 'img/favicon.ico' %}">
    <!-- Tweaks for older IEs--><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
  </head>
  <body>
    <div class="page">
      <!-- Main Navbar-->
      <header class="header">
        <nav class="navbar">
          <!-- Search Box-->
          <div class="search-box">
            <button class="dismiss"><i class="icon-close"></i></button>
            <form id="searchForm" action="#" role="search">
              <input type="search" placeholder="What are you looking for..." class="form-control">
            </form>
          </div>
          <div class="container-fluid">
            <div class="navbar-holder d-flex align-items-center justify-content-between">
              <!-- Navbar Header-->
              <div class="navbar-header">
                <!-- Navbar Brand --><a href="index.html" class="navbar-brand d-none d-sm-inline-block">
                  <div class="brand-text d-none d-lg-inline-block"><strong>郑州市建筑劳务监管平台</strong></div>
                  <div class="brand-text d-none d-sm-inline-block d-lg-none"><strong>BD</strong></div></a>
                <!-- Toggle Button--><a id="toggle-btn" href="#" class="menu-btn active"><span></span><span></span><span></span></a>
              </div>
              <!-- Navbar Menu -->
              <ul class="nav-menu list-unstyled d-flex flex-md-row align-items-md-center">
                <!-- Search-->
                <li class="nav-item d-flex align-items-center"><a id="search" href="#"><i class="icon-search"></i></a></li>
                <!-- Notifications-->
                <li class="nav-item dropdown"> <a id="notifications" rel="nofollow" data-target="#" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="nav-link"><i class="fa fa-bell-o"></i><span class="badge bg-red badge-corner">12</span></a>
                  <ul aria-labelledby="notifications" class="dropdown-menu">
                    <li><a rel="nofollow" href="#" class="dropdown-item"> 
                        <div class="notification">
                          <div class="notification-content"><i class="fa fa-envelope bg-green"></i>You have 6 new messages </div>
                          <div class="notification-time"><small>4 minutes ago</small></div>
                        </div></a></li>
                    <li><a rel="nofollow" href="#" class="dropdown-item"> 
                        <div class="notification">
                          <div class="notification-content"><i class="fa fa-twitter bg-blue"></i>You have 2 followers</div>
                          <div class="notification-time"><small>4 minutes ago</small></div>
                        </div></a></li>
                    <li><a rel="nofollow" href="#" class="dropdown-item"> 
                        <div class="notification">
                          <div class="notification-content"><i class="fa fa-upload bg-orange"></i>Server Rebooted</div>
                          <div class="notification-time"><small>4 minutes ago</small></div>
                        </div></a></li>
                    <li><a rel="nofollow" href="#" class="dropdown-item"> 
                        <div class="notification">
                          <div class="notification-content"><i class="fa fa-twitter bg-blue"></i>You have 2 followers</div>
                          <div class="notification-time"><small>10 minutes ago</small></div>
                        </div></a></li>
                    <li><a rel="nofollow" href="#" class="dropdown-item all-notifications text-center"> <strong>view all notifications                                            </strong></a></li>
                  </ul>
                </li>
                <!-- Messages                        -->
                <li class="nav-item dropdown"> <a id="messages" rel="nofollow" data-target="#" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="nav-link"><i class="fa fa-envelope-o"></i><span class="badge bg-orange badge-corner">10</span></a>
                  <ul aria-labelledby="notifications" class="dropdown-menu">
                    <li><a rel="nofollow" href="#" class="dropdown-item d-flex"> 
                        <div class="msg-profile"> <img src="{% static 'img/avatar-1.jpg' %}" alt="..." class="img-fluid rounded-circle"></div>
                        <div class="msg-body">
                          <h3 class="h5">Jason Doe</h3><span>Sent You Message</span>
                        </div></a></li>
                    <li><a rel="nofollow" href="#" class="dropdown-item d-flex"> 
                        <div class="msg-profile"> <img src="{% static 'img/avatar-2.jpg' %}" alt="..." class="img-fluid rounded-circle"></div>
                        <div class="msg-body">
                          <h3 class="h5">Frank Williams</h3><span>Sent You Message</span>
                        </div></a></li>
                    <li><a rel="nofollow" href="#" class="dropdown-item d-flex"> 
                        <div class="msg-profile"> <img src="{% static 'img/avatar-3.jpg' %}" alt="..." class="img-fluid rounded-circle"></div>
                        <div class="msg-body">
                          <h3 class="h5">Ashley Wood</h3><span>Sent You Message</span>
                        </div></a></li>
                    <li><a rel="nofollow" href="#" class="dropdown-item all-notifications text-center"> <strong>Read all messages   </strong></a></li>
                  </ul>
                </li>
                <!-- Languages dropdown    -->
                <li class="nav-item dropdown"><a id="languages" rel="nofollow" data-target="#" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="nav-link language dropdown-toggle"><img src="{% static 'img/flags/16/GB.png' %}" alt="English"><span class="d-none d-sm-inline-block">English</span></a>
                  <ul aria-labelledby="languages" class="dropdown-menu">
                    <li><a rel="nofollow" href="#" class="dropdown-item"> <img src="{% static 'img/flags/16/DE.png' %}" alt="English" class="mr-2">German</a></li>
                    <li><a rel="nofollow" href="#" class="dropdown-item"> <img src="{% static 'img/flags/16/FR.png' %}" alt="English" class="mr-2">French                                         </a></li>
                  </ul>
                </li>
                <!-- Logout    -->
                <li class="nav-item"><a href="/building/logout/" class="nav-link logout"> <span class="d-none d-sm-inline">注销</span><i class="fa fa-sign-out"></i></a></li>
              </ul>
            </div>
          </div>
        </nav>
      </header>
      <div class="page-content d-flex align-items-stretch"> 
        <!-- Side Navbar -->
        <nav class="side-navbar">
          <!-- Sidebar Header-->
          <div class="sidebar-header d-flex align-items-center">
            <div class="avatar"><img src="{% static 'img/avatar-1.jpg' %}" alt="..." class="img-fluid rounded-circle"></div>
            <div class="title">
              <h1 class="h4">Mark Stephen</h1>
              <p>Web Designer</p>
            </div>
          </div>
          <!-- Sidebar Navidation Menus--><span class="heading">Main</span>
            <ul class="list-unstyled">
                <li><a href="/building/index"> <i class="icon-home"></i>首页 </a></li>
                <li><a href="#businessdropdownDropdown" aria-expanded="false" data-toggle="collapse"> <i class="icon-interface-windows"></i>企业管理 </a>
                    <ul id="businessdropdownDropdown" class="collapse list-unstyled">
                        <li><a href="/building/business/manager/1/">企业信息</a></li>
                        <li><a href="/building/business/count/">企业统计</a></li>
                    </ul>
                </li>
                <li><a href="#projectdropdownDropdown" aria-expanded="false" data-toggle="collapse"> <i class="icon-grid"></i>项目管理 </a>
                    <ul id="projectdropdownDropdown" class="collapse list-unstyled show">
                        <li class="active"><a href="/building/project/manager/1/">项目信息</a></li>
                        <li><a href="#">项目统计</a></li>
                    </ul>
                </li>
                <li><a href="#salarydropdownDropdown" aria-expanded="false" data-toggle="collapse"> <i class="icon-padnote"></i>劳务管理 </a>
                    <ul id="salarydropdownDropdown" class="collapse list-unstyled ">
                        <li><a href="#">劳务考勤</a></li>
                        <li><a href="#">工资统计</a></li>
                        <li><a href="/building/salary/check/">工资核对</a></li>
                    </ul>
                </li>
          </ul><span class="heading">附加功能</span>
          <ul class="list-unstyled">
            <li> <a href="#"> <i class="icon-flask"></i>Demo </a></li>
            <li> <a href="#"> <i class="icon-screen"></i>Demo </a></li>
            <li> <a href="#"> <i class="icon-mail"></i>Demo </a></li>
            <li> <a href="#"> <i class="icon-picture"></i>Demo </a></li>
          </ul>
        </nav>
        <div class="content-inner">
          <!-- Page Header-->
          <header class="page-header">
            <div class="container-fluid">
              <h2 class="no-margin-bottom">企业信息查询</h2>
            </div>
          </header>
          <!-- Breadcrumb-->
          <div class="breadcrumb-holder container-fluid">
            <ul class="breadcrumb">
              <li class="breadcrumb-item"><a href="/building/index/">首页</a></li>
              <li class="breadcrumb-item active">项目信息            </li>
            </ul>
          </div>
          <section class="tables">
            <div class="container-fluid">
                <button type="button" data-toggle="modal" data-target="#myModal" class="btn btn-primary">搜索 </button>
                <button type="button"  class="btn btn-info" onclick="print()">打印 </button>
                <button type="button"  class="btn btn-danger" onclick="load()">下载 </button><br><br>
                <div id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" class="modal fade text-left">
                    <div role="document" class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h4 id="exampleModalLabel" class="modal-title">搜索项目</h4>
                                <button type="button" data-dismiss="modal" aria-label="Close" class="close"><span aria-hidden="true">×</span></button>
                            </div>
                            <div class="modal-body">
                                <form>
                                    <div class="form-group">
                                        <label>项目名称</label>
                                        <input type="text" placeholder="项目名称" class="form-control" id="project_name">
                                    </div>
                                    <div class="form-group">
                                        <label>项目编号</label>
                                        <input type="text" placeholder="项目编号" class="form-control" id="project_id">
                                    </div>
                                    <div class="form-group">
                                        <label>工程进度</label>
                                        <select id="assess" class="form-control col-md-6" >
                                            <option>审批未开工</option>
                                            <option>在建</option>
                                            <option>停工</option>
                                            <option>竣工</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>所属区域</label>
                                        <select id="assess" class="form-control col-md-6" >
                                            <option>二七区</option>
                                            <option>中原区</option>
                                            <option>金水区</option>
                                            <option>新郑市</option>
                                            <option>惠济区</option>
                                            <option>管城回族区</option>
                                            <option>上街区</option>
                                            <option>登封市</option>
                                            <option>新密市</option>
                                            <option>巩义市</option>
                                            <option>中牟县</option>
                                            <option>高新区</option>
                                            <option>荥阳市</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>建筑单位</label>
                                        <input type="text" placeholder="建筑单位" class="form-control" id="project_unit">
                                    </div>
                                    <div class="form-group">
                                        <label>建筑企业</label>
                                        <input type="text" placeholder="建筑企业" class="form-control" id="project_company">
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" data-dismiss="modal" class="btn btn-secondary">关闭</button>
                                <button type="button" class="btn btn-primary">搜索</button>
                            </div>
                        </div>
                    </div>
                </div>
              <div class="row">
                <div class="col-lg-12">
                  <div class="card">
                    <div class="card-header d-flex align-items-center">
                      <h3 class="h4">项目信息</h3>
                    </div>
                    <div class="card-body">
                      <div class="table-responsive">
                        <table class="table table-striped" id="project">
                          <thead>
                            <tr>
                                <th>工程编号</th>
                                <th>工程名称</th>
                                <th>工程负责人</th>
                                <th>建筑单位</th>
                                <th>建筑企业</th>
                                <th>工程进度</th>
                            </tr>
                          </thead>
                            {% for i in page %}
                                <tbody>
                                <tr>
                                    <td>{{ i.pro_id }}</td>
                                    <td class="text-nowrap" ><a href="/building/project/information/{{ i.pro_id }}/">{{ i.project_name }}</a></td>
                                    <td>{{ i.project_manager }}</td>
                                    <td>{{ i.project_unit }}</td>
                                    <td>{{ i.project_company.business_name }}</td>
                                    <td>{{ i.project_plan }}</td>
                                </tr>
                                </tbody>
                            {% endfor %}
                        </table>
                      <!--分页导航栏-->
                          <div align="center">
                              共<span id="totalNumber" style="color: dodgerblue">{{ pag.count }}</span>条   
                              当前第<span id="currentPage" style="color: black">{{ page.number }}</span>/<span id="totalPage" style="color: black">{{ pag.num_pages }}</span>页
                                 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                              <button id="Previous" class="btn btn-default" onclick="pre_page()">上一页</button>
                              <button id="Next" class="btn btn-default" onclick="next_page()">下一页</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                              跳至&nbsp;<input id="pageNumber" type="number" min="1" max="100" style="width: 78px; text-align: center">&nbsp;页&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                              <button id="goPage" type="button" class="btn btn-primary" onclick="skip()">GO</button>
                          </div>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          </section>

        </div>
      </div>
    </div>
    <!-- JavaScript files-->
    <script src="{% static '/js/vendor/jquery/jquery.min.js' %}"></script>
    <script src="{% static '/js/vendor/popper.js/umd/popper.min.js' %}"> </script>
    <script src="{% static '/js/vendor/bootstrap/bootstrap.min.js' %}"></script>
    <script src="{% static '/js/vendor/jquery.cookie.js' %}"> </script>
    <script src="{% static '/js/vendor/chart.js/Chart.min.js' %}"></script>
    <script src="{% static '/js/vendor/jquery-validation/jquery.validate.min.js' %}"></script>
    <script src="{% static 'js/charts-home.js' %}"></script>
    <!-- Main File-->
  <script src="{% static '/js/front.js' %}"></script>
  <script>
    $("#search").on("click",function(){
            $.ajax({
                url :"/building/project/manager/",
                type:"POST",
				data:{"project_name":$("#project_name").val(),"project_id":$("#project_id").val(),"project_unit":$("#project_unit").val(),"project_company":$("#project_company").val()},
                dataType : "Json",
                success:function (SearchSet) {
                    alert(SearchSet["SearchSet"])
                },
            });
        });
     <!-- 跳转到上一页面-->
      function pre_page() {
          if(({{ page.number }})>1)
          {
              window.location.href="/building/project/manager/{{ page.number|add:-1 }}"
          }
      }
      <!-- 跳转到下一页面-->
      function next_page() {
          if(({{ page.number}})<({{ pag.num_pages }}))
          {
              window.location.href="/building/project/manager/{{ page.number|add:1 }}"
          }
      }
     <!--跳转到指定页面-->
     function skip() {
         pageNumber = $("#pageNumber").val();
         pageNumbers = parseInt(pageNumber);
         if(pageNumbers>0)
         {
             if(pageNumbers<={{ pag.num_pages }})
             {
                 window.location.href=("/building/project/manager/"+pageNumber)
             }
             else {
                 window.location.href="/building/project/manager/"
             }
         }
         else {
             window.location.href="/building/project/manager/"
         }
      }
    <!-- 导出成excel-->
    var tableId = document.getElementById("project");
    function load() {
        methodtable2excel(tableId);
    }
    var idTmr;
    function  getExplorer() {
        var explorer = window.navigator.userAgent ;
        //ie
        if (explorer.indexOf("MSIE") >= 0) {
            return 'ie';
        }
        //firefox
        else if (explorer.indexOf("Firefox") >= 0) {
            return 'Firefox';
        }
        //Chrome
        else if(explorer.indexOf("Chrome") >= 0){
            return 'Chrome';
        }
        //Opera
        else if(explorer.indexOf("Opera") >= 0){
            return 'Opera';
        }
        //Safari
        else if(explorer.indexOf("Safari") >= 0){
            return 'Safari';
        }
    }
    function methodtable2excel(tableid) {//整个表格拷贝到EXCEL中
        if(getExplorer()=='ie')
        {
            var curTbl = document.getElementById(tableid);
            var oXL = new ActiveXObject("Excel.Application");//创建AX对象excel

            var oWB = oXL.Workbooks.Add();//获取workbook对象
            var xlsheet = oWB.Worksheets(1);//激活当前sheet
            var sel = document.body.createTextRange();
            sel.moveToElementText(curTbl);//把表格中的内容移到TextRange中
            sel.select();//全选TextRange中内容
            sel.execCommand("Copy");//复制TextRange中内容
            xlsheet.Paste();//粘贴到活动的EXCEL中
            oXL.Visible = true;//设置excel可见属性

            try {
                var fname = oXL.Application.GetSaveAsFilename("Excel.xls", "Excel Spreadsheets (*.xls), *.xls");
            } catch (e) {
                print("Nested catch caught " + e);
            } finally {
                oWB.SaveAs(fname);
                oWB.Close(savechanges = false);
                //xls.visible = false;
                oXL.Quit();
                oXL = null;
                //结束excel进程，退出完成
                //window.setInterval("Cleanup();",1);
                idTmr = window.setInterval("Cleanup();", 1);
            }
        }
        else
        {
            tableToExcel(tableid);
        }
    }
    function Cleanup() {
        window.clearInterval(idTmr);
        CollectGarbage();
    }
    var tableToExcel = (function() {
        var uri = 'data:application/vnd.ms-excel;base64,',
            template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><meta charset="UTF-8"></head><body><table>{table}</table></body></html>',
            base64 = function(s) { return window.btoa(unescape(encodeURIComponent(s))) },
            format = function(s, c) {
                return s.replace(/{(\w+)}/g,
                    function(m, p) { return c[p]; }) };
        return function(table, name) {
            if (!table.nodeType) table = document.getElementById(table);
            var ctx = {worksheet: name || 'Worksheet', table: table.innerHTML};
            window.location.href = uri + base64(format(template, ctx))
        }
    })();
</script>
  </body>
</html>